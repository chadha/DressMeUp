/*
 * OpenTag, a tag deployment platform
 * Copyright 2011-2012, QuBit Group
 * http://opentag.qubitproducts.com
 */

try{(function(){var c={};c.html={};c.html.fileLoader={};c.html.fileLoader.load=function(q,B,D,z,w,x){var t,u,A,v,y;y=false;v=function(E){return function(){if(!y){y=true;if(E&&!A){A={url:document.location.href}}D(q,A,E)}}};try{if(B){u=B(q)}}catch(C){u=false;D(q,"Exception loading pre",true)}finally{if(u!==false){t=c.html.fileLoader.createScriptEl(q,w,false,x);if(D){t.onload=v(false);t.onerror=v(true);t.onreadystatechange=function(){if((this.readyState==="complete")||(this.readyState==="loaded")){setTimeout(function(){v(false)()},1)}}}if(!z){z=window.document.getElementsByTagName("head")[0]}z.appendChild(t)}}};c.html.fileLoader.createScriptEl=function(w,v,x,q){var t,u=document.createElement("script");u.type="text/javascript";u.src=c.html.fileLoader.tidyUrl(w)+(x?("?"+new Date().getTime()):"");if(v!==false){u.async="true";u.defer="true"}else{u.async="false";if(u.async!==false){u.async=false}u.defer="false"}for(t in q){if(q.hasOwnProperty(t)){u.setAttribute(t,q[t])}}return u};c.html.fileLoader.tidyUrl=function(q){if(q.substring(0,5)==="http:"){return q}if(q.substring(0,6)==="https:"){return q}return"//"+q};c.html.PostData=function(v,z,B){var A,x,D,w,u,C,y,t,E,q;q=5;E=2000;y=false;t=function(){if(q>0){setTimeout(function(){if(!y){q-=1;A()}},E)}};x=navigator.userAgent.toLowerCase();D=x.indexOf("msie")!==-1;w=x.indexOf("msie 9")!==-1;u=((x.indexOf("msie 7")!==-1)||(x.indexOf("msie 6")!==-1));C=("https:"===document.location.protocol?"https:":"http:")+v;B=B||"POST";A=function(){var K;try{K=null;try{K=new XMLHttpRequest()}catch(J){}if(K&&!D){K.open(B,C,true)}else{if(typeof XDomainRequest!=="undefined"){K=new XDomainRequest();K.open(B,C)}else{K=null}}try{K.withCredentials=false}catch(I){}if(K.setRequestHeader){K.setRequestHeader("Content-Type","text/plain;charset=UTF-8")}K.onload=function(){y=true};K.onreadystatechange=function(){};K.ontimeout=function(){};K.onerror=function(){};K.onprogress=function(){};K.send(z)}catch(G){try{try{c.html.fileLoader.load(C)}catch(F){if(window.console&&window.console.log){window.console.log(G)}}}catch(H){}}t()};if(u){c.html.fileLoader.load(C);return}else{A()}};c.html.GlobalEval={};c.html.GlobalEval.globalEval=function(t){if(window.execScript){window.execScript(t)}else{var q=function(){window["eval"].call(window,t)};q()}};c.html.HtmlInjector={};c.html.HtmlInjector.inject=function(q,A,z,u,x){var w,D,y,C,v,B,t;if(z.toLowerCase().indexOf("<script")>=0){y=document.createElement("div");y.innerHTML="a"+z;C=y.getElementsByTagName("script");v=[];for(w=0,D=C.length;w<D;w+=1){v.push(C[w])}t=[];for(w=0,D=v.length;w<D;w+=1){B=v[w];var E={attributes:c.html.HtmlInjector.getAttributes(B)};if(B.src){E.src=B.src}else{E.script=B.innerHTML}t.push(E);B.parentNode.removeChild(B)}if(y.innerHTML){if(y.innerHTML.length>0){y.innerHTML=y.innerHTML.substring(1)}}c.html.HtmlInjector.doInject(q,A,y);c.html.HtmlInjector.loadScripts(t,0,u,q)}else{y=document.createElement("div");y.innerHTML=z;c.html.HtmlInjector.doInject(q,A,y);if(u){u()}}};c.html.HtmlInjector.doInject=function(u,t,v){if(v.childNodes.length>0){var q=document.createDocumentFragment();while(v.childNodes.length>0){q.appendChild(v.removeChild(v.childNodes[0]))}if(t){c.html.HtmlInjector.injectAtStart(u,q)}else{c.html.HtmlInjector.injectAtEnd(u,q)}}};c.html.HtmlInjector.injectAtStart=function(t,q){if(t.childNodes.length===0){t.appendChild(q)}else{t.insertBefore(q,t.childNodes[0])}};c.html.HtmlInjector.injectAtEnd=function(u,t,q){if(!q){q=1}if((u===document.body)&&(document.readyState!=="complete")&&(q<50)){setTimeout(function(){c.html.HtmlInjector.injectAtEnd(u,t,q+1)},100)}else{u.appendChild(t)}};c.html.HtmlInjector.loadScripts=function(w,u,t,q){var v,y,x=false;for(v=w.length;u<v;u+=1){y=w[u];if(y.src){x=true;break}else{c.html.GlobalEval.globalEval(y.script)}}if(x){c.html.fileLoader.load(y.src,null,function(){c.html.HtmlInjector.loadScripts(w,u+1,t,q)},q,false,y.attributes)}if(t&&(u===v)){t()}};c.html.HtmlInjector.getAttributes=function(w){var q,v,t,y,u,x={};if(w){t=w.attributes;v=t.length;for(q=0;q<v;q++){y=t[q].value;u=t[q].name.toLowerCase();if((y!=="")&&((u==="id")||(u==="class")||(u==="charset")||(u.substr(0,5)==="data-"))){x[u]=y}}return x}};c.html.simplecookie={};c.html.simplecookie.readCookie=function(q){var x,u,y,w,z,t,v;z=q+"=";w=document.cookie.split(";");x=/^\s+|\s+$/g;for(t=0,v=w.length;t<v;t+=1){u=w[t].replace(x,"");if(u.indexOf(z)===0){y=unescape(u.substring(z.length));if(y.length===0){return null}return y}}return null};c.html.simplecookie.readAllCookies=function(t){var q,u,w,y,A,v,z,x;A=t+"=";y=document.cookie.split(";");q=/^\s+|\s+$/g;x=[];for(v=0,z=y.length;v<z;v+=1){u=y[v].replace(q,"");if(u.indexOf(A)===0){w=unescape(u.substring(A.length));if(w.length>0){x.push(w)}}}return x};c.html.simplecookie.writeCookie=function(u,x,y,w){var t,q,v;if(y){t=new Date();t.setTime(t.getTime()+(y*86400000));q="; expires="+t.toGMTString()}else{q=""}v=escape(u)+"="+escape(x)+q+"; path=/;";if(w){v+=" domain="+w}document.cookie=v};(function(){var u,w=false,y=1,x,t,v,q;t=function(A){var z;if(A===true){y-=1}if(!y||(A!==true&&!w)){if(!document.body){return setTimeout(t,1)}w=true;if(A!==true){y-=1;if(y>0){return}}while(x.length>0){z=x.shift();z()}}};q=function(){if(w){return}try{document.documentElement.doScroll("left")}catch(z){setTimeout(q,1);return}t()};v=function(){if(x){return}x=[];if(document.readyState==="complete"){return setTimeout(t,1)}if(document.addEventListener){document.addEventListener("DOMContentLoaded",u,false);window.addEventListener("load",t,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",u);window.attachEvent("onload",t);var z=false;try{z=(window.frameElement===null)||(window.frameElement===undefined)}catch(A){}if(document.documentElement.doScroll&&z){q()}}}};c.html.ready=function(z){v();if(w){setTimeout(z,1)}else{x.push(z)}};if(document.addEventListener){u=function(){document.removeEventListener("DOMContentLoaded",u,false);t()}}else{if(document.attachEvent){u=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",u);t()}}}}}());c.cookie={};c.cookie.PageView={};c.cookie.PageView.update=function(){var q,u;u=function t(){return(Math.floor(1+Math.random()*65536)).toString(36).substring(1)};if(!window.__pageViewId__){q=new Date().getTime().toString(36);window.__pageViewId__=q+u()+u()+u()}return window.__pageViewId__};c.cookie.SimpleSessionCounter={};c.cookie.SimpleSessionCounter._cookieName="_qst_s";c.cookie.SimpleSessionCounter._sessionCookie="_qsst_s";c.cookie.SimpleSessionCounter.update=function(u){var w,q,v,t=30;w=c.html.simplecookie.readCookie(c.cookie.SimpleSessionCounter._cookieName);q=c.html.simplecookie.readCookie(c.cookie.SimpleSessionCounter._sessionCookie);if(!w){w=1}else{w=parseInt(w,10);if(!q||(parseInt(q,10)<(new Date().getTime()-t*60*1000))){w+=1}}c.html.simplecookie.writeCookie(c.cookie.SimpleSessionCounter._cookieName,w,365,u);c.html.simplecookie.writeCookie(c.cookie.SimpleSessionCounter._sessionCookie,new Date().getTime().toString(),null,u);return w};var r={};(function(){function w(C){return C<10?"0"+C:C}var u=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,y=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,z,t,B={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},A;function q(C){y.lastIndex=0;return y.test(C)?'"'+C.replace(y,function(D){var E=B[D];return typeof E==="string"?E:"\\u"+("0000"+D.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+C+'"'}function v(C){return isFinite(C.valueOf())?C.getUTCFullYear()+"-"+w(C.getUTCMonth()+1)+"-"+w(C.getUTCDate())+"T"+w(C.getUTCHours())+":"+w(C.getUTCMinutes())+":"+w(C.getUTCSeconds())+"Z":null}function x(J,G){var E,D,K,C,H=z,F,I=G[J];if(I instanceof Date){I=v(I)}else{if((I instanceof String)||(I instanceof Number)||(I instanceof Boolean)){I=I.valueOf()}}if(typeof A==="function"){I=A.call(G,J,I)}switch(typeof I){case"string":return q(I);
case"number":return isFinite(I)?String(I):"null";case"boolean":case"null":return String(I);case"object":if(!I){return"null"}z+=t;F=[];if(Object.prototype.toString.apply(I)==="[object Array]"){C=I.length;for(E=0;E<C;E+=1){F[E]=x(E,I)||"null"}K=F.length===0?"[]":z?"[\n"+z+F.join(",\n"+z)+"\n"+H+"]":"["+F.join(",")+"]";z=H;return K}if(A&&typeof A==="object"){C=A.length;for(E=0;E<C;E+=1){if(typeof A[E]==="string"){D=A[E];K=x(D,I);if(K){F.push(q(D)+(z?": ":":")+K)}}}}else{for(D in I){if(Object.prototype.hasOwnProperty.call(I,D)){K=x(D,I);if(K){F.push(q(D)+(z?": ":":")+K)}}}}K=F.length===0?"{}":z?"{\n"+z+F.join(",\n"+z)+"\n"+H+"}":"{"+F.join(",")+"}";z=H;return K}}if(typeof r.stringify!=="function"){r.stringify=function(F,D,E){var C;z="";t="";if(typeof E==="number"){for(C=0;C<E;C+=1){t+=" "}}else{if(typeof E==="string"){t=E}}A=D;if(D&&typeof D!=="function"&&(typeof D!=="object"||typeof D.length!=="number")){throw new Error("JSON.stringify")}return x("",{"":F})}}if(typeof r.parse!=="function"){r.parse=function(F,C){var E;function D(J,I){var H,G,K=J[I];if(K&&typeof K==="object"){for(H in K){if(Object.prototype.hasOwnProperty.call(K,H)){G=D(K,H);if(G!==undefined){K[H]=G}else{delete K[H]}}}}return C.call(J,I,K)}F=String(F);u.lastIndex=0;if(u.test(F)){F=F.replace(u,function(G){return"\\u"+("0000"+G.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(F.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){E=eval("("+F+")");return typeof C==="function"?D({"":E},""):E}throw new SyntaxError("JSON.parse")}}}());var f=false;var j="";f=true;var d=[],h={},n={},p=false,g="",b="",o=0,i=3000,k=null;var g="31935";var b="42598";var d=[{filterType:"1",name:"default",patternType:"1",pattern:"",priority:1,id:-1,scriptLoaderKeys:["391261"]},{filterType:"1",name:"default",patternType:"1",pattern:"",priority:1,id:-1,scriptLoaderKeys:["391269"]},{filterType:"1",name:"all",patternType:"1",pattern:"",priority:1,id:6419796,scriptLoaderKeys:["455119"]},{filterType:"1",name:"Runtest T003",patternType:"2",pattern:"runt003",priority:1,id:6419832,scriptLoaderKeys:["3880234"]},{filterType:"1",name:"Expose session",patternType:"100",pattern:function(q){window.qb_session=q;return true},starter:function(t,q){q()},priority:1,id:7451752,scriptLoaderKeys:["4114904"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:9338656,scriptLoaderKeys:["7569184"]},{filterType:"1",name:"Product Page Only",patternType:"2",pattern:"ProductDisplay",priority:1,id:10264721,scriptLoaderKeys:["8366527"]},{filterType:"1",name:"Default filter: Match all",patternType:"1",pattern:"",priority:1,id:11122099,scriptLoaderKeys:["9098998"]}];var h={};var n={391261:{id:"391261",name:"QuBit QTracker",pre:"window._qtd = window._qtd || [];\x0A      window._qtd.push({\x0A        options: {\x0A          doCd: true,\x0A        cdClient: \x2231935xd\x22,\x0A          domain: \x22www.topshop.com\x22,\x0A          serverUrl: \x22pong.qubitproducts.com/t2\x22,\x0A          clientId: \x22topshop\x22\x0A        }\x0A      });",url:"dtxtngytz5im1.cloudfront.net/qtracker-legacy.min.js",post:"(function() {\x0A  var s = document.createElement(\x27script\x27);\x0A  s.src=\x22//s3-eu-west-1.amazonaws.com/qubit-client/Arcadia/tracker.js\x22;\x0A  document.getElementsByTagName(\x27head\x27)[0].appendChild(s);\x0A})();",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[7569184]},391269:{id:"391269",name:"QuBit Interaction Analytics",pre:"window._qHf = []; window._qHf.push([\x27_qHfAccount\x27, \x27topshop\x27]);",url:"d2x3hsvuvvta8c.cloudfront.net/fp.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[7569184]},455119:{id:"455119",name:"QuBit Exit Feedback",pre:"window.q_fb_opts = {\x22showProb\x22:0.8,\x22returnTime\x22:395,\x22attachTime\x22:2000,\x22journeyDepth\x22:2,\x22container\x22:{\x22template\x22:\x22<a href=\x27#\x27 class=\x27close\x27></a> <div id=\x27main\x27>   <div class=\x27content\x27></div> </div> <img style=\x5C\x22display: none;\x5C\x22 src=\x5C\x22https://s3-eu-west-1.amazonaws.com/qubittracker/arcadia/topshop/ef/ts-thanks.png\x5C\x22>  <div id=\x27bottom\x27></div>\x22,\x22width\x22:443,\x22height\x22:257},\x22cssExtra\x22:\x22#main {  height: 410px;  width: 725px;  padding: 0px;  margin: 10px;  border: 0px solid #A3A3A3;  background: none;  margin-top: 16px;   /*  box-shadow: 0 0 18px #666;  -webkit-box-shadow: 0 0 18px #666;  -moz-box-shadow: 0 0 18px #666;  */ }   #bottom {  display: none; }  .content {  background-color: none;  padding: 0px;  background: url(\x27https://s3-eu-west-1.amazonaws.com/qubittracker/arcadia/topshop/ef/ts-ask.png\x27) no-repeat top left;  height: 100%;  width: 100%;  }  .content.thankYou {  background: url(\x27https://s3-eu-west-1.amazonaws.com/qubittracker/arcadia/topshop/ef/ts-thanks.png\x27) no-repeat top left;  cursor: pointer; }   h1, p {  display: none; }  .text {  height: 78px; } textarea {  position: absolute;  left: 29px;  width: 389px;  top: 127px;  font-family: arial, sans-serif;  border-radius: 6px; }  .send, .enabled .send:hover {  position: absolute;  bottom: 23px;  height: 19px;  width: 61px;  border: 0;  left: 29px;  background: url(\x5C\x22https://s3-eu-west-1.amazonaws.com/qubittracker/arcadia/topshop/ef/ts-submit.png\x5C\x22) center;  font-size: 0px;   padding: 0px;   border-radius: 0px;  margin: 0px;   filter:; }  .close {  position: absolute;  left: auto;  right: -2px;  top: 27px;  background: url(\x5C\x22https://s3-eu-west-1.amazonaws.com/qubittracker/arcadia/topshop/ef/ts-close.png\x5C\x22) no-repeat;  opacity: 100;  width: 40px;  height: 40px;  filter:; }\x22,\x22trackingId\x22:\x22topshop\x22,\x22domain\x22:\x22www.topshop.com\x22,\x22clientId\x22:31935,\x22profileId\x22:1041,\x22configId\x22:31};",url:"dtxtngytz5im1.cloudfront.net/feedback-min.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[7569184]},3880234:{id:"3880234",name:"QuBit ETC - T003 Currency Exchange",pre:"(function() {\x0A  var Helper, Variant, Variant1, activation, clientId, creative, creatives, criteria, criteriaID, dependencies, domain, experiment, key, name, targetingCriteria, _base, _base1, _base2,\x0A    __slice = [].slice,\x0A    __hasProp = {}.hasOwnProperty,\x0A    __extends = function(child, parent) { for (var key in parent) { if (__hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; };\x0A\x0A  Helper = (function() {\x0A\x0A    function Helper() {}\x0A\x0A    Helper.addStyleSheet = function(css) {\x0A      var head, styleElement;\x0A      head = document.getElementsByTagName(\x27head\x27)[0];\x0A      styleElement = document.createElement(\x27style\x27);\x0A      styleElement.setAttribute(\x27type\x27, \x27text/css\x27);\x0A      if (styleElement.styleSheet) {\x0A        styleElement.styleSheet.cssText = css;\x0A      } else {\x0A        styleElement.appendChild(document.createTextNode(css));\x0A      }\x0A      head.appendChild(styleElement);\x0A      return styleElement;\x0A    };\x0A\x0A    Helper.flickerCssNodes = [];\x0A\x0A    Helper.hideFlickerElements = function() {\x0A      var css, selector, selectors;\x0A      selectors = 1 <= arguments.length ? __slice.call(arguments, 0) : [];\x0A      css = ((function() {\x0A        var _i, _len, _results;\x0A        _results = [];\x0A        for (_i = 0, _len = selectors.length; _i < _len; _i++) {\x0A          selector = selectors[_i];\x0A          _results.push(selector + \x22{display:none;}\x22);\x0A        }\x0A        return _results;\x0A      })()).join(\x22\x5Cn\x22);\x0A      Helper.flickerCssNodes.push(Helper.addStyleSheet(css));\x0A      return setTimeout(Helper.showFlickerElements, 2000);\x0A    };\x0A\x0A    Helper.showFlickerElements = function() {\x0A      var cssNode, _i, _len, _ref, _ref1, _results;\x0A      _ref = Helper.flickerCssNodes;\x0A      _results = [];\x0A      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\x0A        cssNode = _ref[_i];\x0A        _results.push(cssNode != null ? (_ref1 = cssNode.parentNode) != null ? _ref1.removeChild(cssNode) : void 0 : void 0);\x0A      }\x0A      return _results;\x0A    };\x0A\x0A    Helper.createCookie = function(name, value, days) {\x0A      var date, expires;\x0A      if (days != null) {\x0A        date = new Date();\x0A        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\x0A        expires = \x22; expires=\x22 + date.toGMTString();\x0A      } else {\x0A        expires = \x22\x22;\x0A      }\x0A      return document.cookie = \x22\x22 + name + \x22=\x22 + value + expires + \x22; path=/\x22;\x0A    };\x0A\x0A    Helper.readCookie = function(name) {\x0A      var c, ca, nameEQ, _i, _len;\x0A      nameEQ = name + \x22=\x22;\x0A      ca = document.cookie.split(\x27;\x27);\x0A      for (_i = 0, _len = ca.length; _i < _len; _i++) {\x0A        c = ca[_i];\x0A        while (c.charAt(0) === \x27 \x27) {\x0A          c = c.substring(1, c.length);\x0A        }\x0A        if (c.indexOf(nameEQ) === 0) {\x0A          return c.substring(nameEQ.length, c.length);\x0A        }\x0A      }\x0A      return null;\x0A    };\x0A\x0A    Helper.eraseCookie = function(name) {\x0A      return Helper.createCookie(name, \x22\x22, -1);\x0A    };\x0A\x0A    Helper.getElementByClassName = function(className, tag) {\x0A      var current, elements, returnElements, testClass, _i, _len;\x0A      testClass = new RegExp(\x22(^|\x5C\x5Cs)\x22 + className + \x22(\x5C\x5Cs|$)\x22);\x0A      tag = tag || \x22*\x22;\x0A      elements = document.getElementsByTagName(tag);\x0A      returnElements = [];\x0A      for (_i = 0, _len = elements.length; _i < _len; _i++) {\x0A        current = elements[_i];\x0A        if (testClass.test(current.className)) {\x0A          returnElements.push(current);\x0A        }\x0A      }\x0A      return returnElements;\x0A    };\x0A\x0A    Helper.pollThen = function(pollFunc, afterFunc, startTime, maxPolls) {\x0A      var poller, polls, time;\x0A      if (startTime == null) {\x0A        startTime = 100;\x0A      }\x0A      if (maxPolls == null) {\x0A        maxPolls = 15;\x0A      }\x0A      time = startTime;\x0A      polls = 0;\x0A      return (poller = function() {\x0A        var pollReturn;\x0A        if (++polls === maxPolls) {\x0A          return;\x0A        }\x0A        pollReturn = pollFunc();\x0A        if (pollReturn) {\x0A          return afterFunc(pollReturn);\x0A        } else {\x0A          time = time * (polls + 1);\x0A          return setTimeout(poller, time);\x0A        }\x0A      })();\x0A    };\x0A\x0A    Helper.trackEvent = function(name, cb) {\x0A      this.pollThen(function() {\x0A        return window._qtd;\x0A      }, function() {\x0A        return window._qtd.push({\x0A          data: {\x0A            _c_evt_cl_txt: name\x0A          }\x0A        });\x0A      });\x0A      if (cb) {\x0A        return setTimeout(cb, 500);\x0A      }\x0A    };\x0A\x0A    return Helper;\x0A\x0A  }).call(this);\x0A\x0A  Variant = (function() {\x0A    var $;\x0A\x0A    $ = window.jQuery;\x0A\x0A    function Variant() {\x0A      this.addStyleSheet();\x0A    }\x0A\x0A    Variant.prototype.addStyleSheet = function(css) {\x0A      if (css == null) {\x0A        css = typeof this.css === \x22function\x22 ? this.css() : void 0;\x0A      }\x0A      if (css) {\x0A        return Helper.addStyleSheet(css);\x0A      }\x0A    };\x0A\x0A    Variant.prototype.loadExternalJS = function(_src, cb) {\x0A      var counter, s;\x0A      s = document.createElement(\x22script\x22);\x0A      s.type = \x22text/javascript\x22;\x0A      s.src = _src;\x0A      if (cb != null) {\x0A        counter = 0;\x0A        s.onreadystatechange = s.onload = function() {\x0A          var state;\x0A          if (counter === 0) {\x0A            state = s.readyState;\x0A            if (!state || /loaded|complete/.test(state)) {\x0A              counter++;\x0A              return cb();\x0A            }\x0A          }\x0A        };\x0A      }\x0A      return (document.body || document.documentElement).appendChild(s);\x0A    };\x0A\x0A    Variant.prototype.withJquery = function(cb) {\x0A      var version;\x0A      if (typeof arguments[0] === \x22string\x22) {\x0A        version = arguments[0];\x0A        cb = arguments[1];\x0A      }\x0A      if (($ != null) && !version) {\x0A        return cb($);\x0A      } else {\x0A        return this.loadExternalJquery(version, cb);\x0A      }\x0A    };\x0A\x0A    Variant.prototype.firedLoadExternalJquery = false;\x0A\x0A    Variant.prototype.loadExternalJquery = function(version, cb) {\x0A      var counter, s;\x0A      if (version == null) {\x0A        version = \x221.8.0\x22;\x0A      }\x0A      if (!this.firedLoadExternalJquery) {\x0A        this.firedLoadExternalJquery = true;\x0A        s = document.createElement(\x22script\x22);\x0A        s.type = \x22text/javascript\x22;\x0A        s.src = \x22https://ajax.googleapis.com/ajax/libs/jquery/\x22 + version + \x22/jquery.min.js\x22;\x0A        counter = 0;\x0A        s.onreadystatechange = s.onload = function() {\x0A          var state;\x0A          if (counter === 0) {\x0A            state = s.readyState;\x0A            if (!state || /loaded|complete/.test(state)) {\x0A              $ = window.jQuery.noConflict(true);\x0A              counter++;\x0A              return cb($);\x0A            }\x0A          }\x0A        };\x0A        return (document.body || document.documentElement).appendChild(s);\x0A      } else {\x0A        return cb($);\x0A      }\x0A    };\x0A\x0A    return Variant;\x0A\x0A  })();\x0A\x0A  Variant1 = (function(_super) {\x0A    var $;\x0A\x0A    __extends(Variant1, _super);\x0A\x0A    $ = window.jQuery;\x0A\x0A    Variant1.prototype.css = function() {\x0A      return \x22\x22;\x0A    };\x0A\x0A    function Variant1() {\x0A      var _this = this;\x0A      Variant1.__super__.constructor.apply(this, arguments);\x0A      this.withJquery(\x221.8.0\x22, function(jq) {\x0A        var convertBubble, price, priceLabelDiv, titleDiv;\x0A        $ = jq;\x0A        priceLabelDiv = $(\x22.product_price\x22).css({\x0A          position: \x22relative\x22\x0A        });\x0A        price = (1.52 * priceLabelDiv.find(\x22span\x22).text().match(/\x5Cu00A3(.*)/)[1]).toFixed(2);\x0A        titleDiv = $(\x22#product_tab_1 h1:first\x22).css({\x0A          marginBottom: 40\x0A        });\x0A        convertBubble = $(\x22<div/>\x22, {\x0A          text: price + \x22 AUD\x22,\x0A          css: {\x0A            background: \x22url(https://s3-eu-west-1.amazonaws.com/qubit-etc/arcadia/topshop/t003-currency-exchange/price-bubble.png)\x22,\x0A            width: 156,\x0A            height: 20,\x0A            top: -32,\x0A            right: 40,\x0A            display: \x22block\x22,\x0A            position: \x22absolute\x22,\x0A            paddingLeft: 3,\x0A            paddingTop: 51,\x0A            textAlign: \x22center\x22,\x0A            fontSize: 10,\x0A            color: \x22red\x22\x0A          }\x0A        });\x0A        return priceLabelDiv.append(convertBubble);\x0A      });\x0A    }\x0A\x0A    return Variant1;\x0A\x0A  })(Variant);\x0A\x0A  dependencies = [\x0A    function() {\x0A      var $;\x0A      return $ = window.jQuery;\x0A    }, function() {\x0A      return $(\x22#product_tab_1 h1:first\x22).length;\x0A    }, function() {\x0A      return $(\x22.product_price\x22).length;\x0A    }\x0A  ];\x0A\x0A  activation = function(cb) {\x0A    if (/ignoreActivation/.test(document.location.href)) {\x0A      return cb();\x0A    }\x0A    if (/.*/.test(document.location.href)) {\x0A      return cb();\x0A    }\x0A  };\x0A\x0A  clientId = \x22topshop\x22;\x0A\x0A  domain = \x22.topshop.com\x22;\x0A\x0A  experiment = {\x0A    id: \x22t003-currency-exchange\x22,\x0A    ordered: true\x0A  };\x0A\x0A  targetingCriteria = {\x0A    condition: function() {\x0A      var ua;\x0A      ua = navigator.userAgent;\x0A      if (/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(ua)) {\x0A        return false;\x0A      }\x0A      if (ua.indexOf(\x22MSIE 7\x22) === -1) {\x0A        return false;\x0A      }\x0A      return true;\x0A    },\x0A    creatives: [\x0A      [\x0A        {\x0A          id: \x22t003-variant\x22,\x0A          p: 0.5\x0A        }, {\x0A          id: \x22t003-control\x22,\x0A          p: 0.5\x0A        }\x0A      ]\x0A    ]\x0A  };\x0A\x0A  creatives = {\x0A    \x22t003-variant\x22: {\x0A      id: \x22t003-variant\x22,\x0A      e_id: \x22t003-currency-exchange\x22,\x0A      activation: activation,\x0A      dependencies: dependencies,\x0A      execution: function() {\x0A        return new Variant1;\x0A      }\x0A    },\x0A    \x22t003-control\x22: {\x0A      id: \x22t003-control\x22,\x0A      e_id: \x22t003-currency-exchange\x22,\x0A      activation: activation,\x0A      dependencies: dependencies,\x0A      execution: function() {}\x0A    }\x0A  };\x0A\x0A  (_base = (window._qbetc || (window._qbetc = [])))[0] || (_base[0] = {\x0A    clientId: clientId,\x0A    domain: domain\x0A  });\x0A\x0A  if (window._qbetc[0].targetingCriteria != null) {\x0A    criteriaID = Math.max((function() {\x0A      var _ref, _results;\x0A      _ref = window._qbetc[0].targetingCriteria;\x0A      _results = [];\x0A      for (key in _ref) {\x0A        criteria = _ref[key];\x0A        _results.push(Number(key) + 1);\x0A      }\x0A      return _results;\x0A    })());\x0A    targetingCriteria.id = criteriaID;\x0A    window._qbetc[0].targetingCriteria[criteriaID] = targetingCriteria;\x0A  } else {\x0A    targetingCriteria.id = 1;\x0A    window._qbetc[0].targetingCriteria = {\x0A      1: targetingCriteria\x0A    };\x0A  }\x0A\x0A  experiment.targetingCriteria = [targetingCriteria.id];\x0A\x0A  ((_base1 = window._qbetc[0]).experiments || (_base1.experiments = [])).push(experiment);\x0A\x0A  (_base2 = window._qbetc[0]).creatives || (_base2.creatives = {});\x0A\x0A  for (name in creatives) {\x0A    creative = creatives[name];\x0A    window._qbetc[0].creatives[name] = creative;\x0A  }\x0A\x0A  /*\x0A  x = document.createElement(\x22script\x22)\x0A  x.src = \x22//dtxtngytz5im1.cloudfront.net/etc-min.js\x22\x0A  document.body.appendChild(x)\x0A  */\x0A\x0A\x0A}).call(this);",url:"dtxtngytz5im1.cloudfront.net/etc-min.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},4114904:{id:"4114904",name:"QuBit SmartServe",pre:"",url:"dd6zx4ibq538k.cloudfront.net/smartserve-1041.js",post:"",html:"",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[7569184]},7569184:{id:"7569184",name:"Reset Qubit cookies",pre:"",url:"",post:"",html:"<script>\x0A(function () {\x0A\x0A  function resetCookies(options) {\x0A  \x0A    var cookies = {\x0A      set: function (name, value, options) {\x0A        var date, expires, cookieDomain;\x0A  \x0A        options.escape = options.escape !== undefined ?  options.escape : true;\x0A  \x0A        if (options.escape) {\x0A          value = escape(value);\x0A        }\x0A  \x0A        if (options.days) {\x0A          date = new Date();\x0A          date.setTime(date.getTime() + (options.days * 1000 * 60 * 60 * 24));\x0A          expires = \x22; expires=\x22  + date.toGMTString();\x0A        } else {\x0A          expires = \x22\x22;\x0A        }\x0A        cookieDomain = options.domain ? \x22; domain=\x22 + options.domain : \x22\x22;\x0A        document.cookie = name + \x22=\x22 + value + expires + \x22; path=/\x22 + cookieDomain;\x0A      },\x0A      get: function (name) {\x0A        try {\x0A          var value, regex;\x0A          regex = new RegExp(name + \x22=([^;]*)\x22);\x0A          value = document.cookie.match(regex)[1];\x0A          return window.unescape(value);\x0A        } catch (e) {}\x0A      },\x0A      remove: function (name, cookieDomain) {\x0A        this.set(name, \x22\x22, {\x0A          days: -1,\x0A          domain: cookieDomain\x0A        });\x0A      }\x0A    };\x0A  \x0A  \x0A    options.domains.find = options.domains.find || [];\x0A  \x0A  \x0A    options.replaceDefaultDomain =\x0A      options.replaceDefaultDomain === true ? true : false;\x0A  \x0A    options.removeUndefinedCookies = options.removeUndefinedCookies === false ? false : true;\x0A  \x0A    if (options.replaceDefaultDomain) {\x0A      options.domains.find.push(false);\x0A    }\x0A  \x0A    // Iterate over each cookie name\x0A    for (var i = 0, ii = options.cookies.length; i < ii; i++) {\x0A      var value, name, duration;\x0A  \x0A  \x0A      name = options.cookies[i].name;\x0A      duration = options.cookies[i].expires;\x0A  \x0A      // Use any domain value as the cookie\x0A      value = cookies.get(name);\x0A  \x0A  \x0A      if (value) {\x0A  \x0A        // Remove for all other domains\x0A        for (var j = 0, jj = options.domains.find.length; j < jj; j++) {\x0A          cookies.remove(name, options.domains.find[j]);\x0A        }\x0A  \x0A        if (options.removeUndefinedCookies && value === \x22undefined\x22) {\x0A          cookies.remove(name, options.domains.replaceWith);\x0A        } else {\x0A  \x0A          // Set the new cookie on the new domain\x0A          cookies.set(name, value, {\x0A            days: duration,\x0A            domain: options.domains.replaceWith\x0A          });\x0A        }\x0A  \x0A  \x0A      }\x0A  \x0A    }\x0A  \x0A  }\x0A\x0A  resetCookies({\x0A    domains: {\x0A      find: [\x0A        \x22.topshop.co.uk\x22\x0A      ],\x0A      replaceWith: \x22www.topshop.co.uk\x22\x0A    },\x0A    cookies: [\x0A      { name: \x22_qst\x22, expires: 365 },\x0A      { name: \x22qbef\x22, expires: 365 },\x0A      { name: \x22ss_opts\x22, expires: 365 },\x0A      { name: \x22qb_ss_status\x22, expires: 365 },\x0A      { name: \x22_qubitTracker\x22, expires: 365 }\x0A    ]\x0A  });\x0A\x0A})();\x0A\x0A<\/script>",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},8366527:{id:"8366527",name:"ProductData Mapping",pre:"",url:"",post:"",html:"<script>\x0Atry {\x0A  (function () {\x0A\x0A    var watchObjectString, watchObject, universal_variable, UVToSMapping, existingKeys,\x0A    StoUVMapping, noNewKeysCount, categoryList;\x0A\x0A    var debugging = /qubit_debug/.test(document.cookie);\x0A\x0A    function log() {\x0A      if (debugging) {\x0A        console.log(arguments);\x0A      }\x0A    }\x0A\x0A\x0A    watchObjectString = \x22window.productData\x22;\x0A    window.universal_variable = window.universal_variable || {};\x0A    universal_variable = window.universal_variable;\x0A\x0A\x0A    function priceMapping(value) {\x0A      evaluateMapping(\x22product.sale_price\x22, value.now.match(/\x5Cd+\x5C.\x5Cd+/)[0]);\x0A    }\x0A\x0A\x0A\x0A    StoUVMapping = {\x0A      id        : \x22product.id\x22,\x0A      colour    : \x22product.color\x22,\x0A      name      : \x22product.name\x22,\x0A      prices    : priceMapping\x0A    };\x0A\x0A\x0A    function getNewKeys(objectToCheck, knownKeys) {\x0A      var newKeys = [];\x0A      for (var key in watchObject) {\x0A        if (watchObject.hasOwnProperty(key)) {\x0A          if (indexOf(knownKeys, key) === -1) {\x0A            newKeys.push(key);\x0A          }\x0A        }\x0A      }\x0A      return newKeys;\x0A    }\x0A\x0A    function indexOf(array, key) {\x0A      var i, ii;\x0A      i = 0;\x0A      ii = array.length;\x0A      for (; i < ii; i++) {\x0A        if (array[i] === key) {\x0A          return i;\x0A        }\x0A      }\x0A      return -1;\x0A    }\x0A\x0A    existingKeys = [];\x0A    noNewKeysCount = 0;\x0A\x0A    function pollForChange() {\x0A      var newSKeys, i, ii, newSKey, mapToUV, mappingAvailable;\x0A      log(\x22Polling\x22);\x0A      log(\x22No new keys count:\x22, noNewKeysCount);\x0A\x0A      if (!watchObject) {\x0A        try {\x0A          watchObject = eval(watchObjectString);\x0A        } catch (e) {}\x0A\x0A        if (!watchObject) {\x0A\x0A          noNewKeysCount++;\x0A\x0A          if (noNewKeysCount < 50) {\x0A            setTimeout(pollForChange, 100);\x0A          }\x0A\x0A          return;\x0A        }\x0A\x0A        noNewKeysCount = 0;\x0A      }\x0A\x0A      newSKeys = getNewKeys(watchObject, existingKeys);\x0A\x0A      if (newSKeys.length > 0) {\x0A        i = 0;\x0A        ii = newSKeys.length;\x0A\x0A        mappingAvailable = false;\x0A        for (; i < ii; i++) {\x0A          newSKey = newSKeys[i];\x0A          mapToUV = StoUVMapping[newSKey];\x0A          if (mapToUV) {\x0A            evaluateMapping(mapToUV, watchObject[newSKey], newSKey);\x0A            mappingAvailable = true;\x0A          }\x0A        }\x0A\x0A        if (mappingAvailable) {\x0A          window._qtd = window._qtd || [];\x0A          window._qtd.push({resendUniversalVariables: 1});\x0A        }\x0A\x0A        existingKeys = existingKeys.concat(newSKeys);\x0A\x0A        log(\x22UVs Mapped\x22);\x0A        noNewKeysCount = 0;\x0A      } else {\x0A        noNewKeysCount++;\x0A      }\x0A\x0A      if (noNewKeysCount < 50 || existingKeys.length === 0) {\x0A        setTimeout(pollForChange, 100);\x0A      }\x0A\x0A    }\x0A\x0A\x0A    // Get all the keys out of a string in an array format\x0A    function keyStringToArr (keyString) {\x0A      keyString = keyString.replace(/\x5C[(\x5Cw+)\x5C]/g, \x27.$1\x27); // convert indexes to properties\x0A      keyString = keyString.replace(/^\x5C./, \x27\x27); // strip a leading dot\x0A      return keyString.split(\x27.\x27);\x0A    }\x0A\x0A\x0A    function evaluateMapping(mapToUV, value, sKey) {\x0A      var i, ii, UVToSet, objectLevels;\x0A      switch (typeof mapToUV) {\x0A      case \x22function\x22:\x0A        mapToUV(value, sKey);\x0A        break;\x0A      case \x22string\x22:\x0A        objectLevels = keyStringToArr(mapToUV);\x0A        i = 0;\x0A        ii = objectLevels.length - 1;\x0A        UVToSet = universal_variable;\x0A        for (; i < ii; i++) {\x0A          UVToSet[objectLevels[i]] = UVToSet[objectLevels[i]] || {};\x0A          UVToSet = UVToSet[objectLevels[i]];\x0A        }\x0A        UVToSet[objectLevels[i]] = value;\x0A        break;\x0A      }\x0A    }\x0A\x0A\x0A    pollForChange();\x0A\x0A  }());\x0A} catch (e) {}\x0A\x0A<\/script>",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[]},9098998:{id:"9098998",name:"Qubit Realtime Ping",pre:"",url:"",post:"",html:"<script>\x0A(function () {\x0A\x0A  if (!window.JSON) {\x0A    return;\x0A  }\x0A\x0A  if (!_qtd.orig_push) {\x0A    _qtd.orig_push = _qtd.push;\x0A  }\x0A\x0A  var cookieDomain = null;\x0A\x0A  var readCookie = function (name) {\x0A    var r, cookie, value, cookies, nameSearchString, i, ii;\x0A    nameSearchString = name + \x22=\x22;\x0A    cookies = document.cookie.split(\x27;\x27);\x0A    r = /^\x5Cs+|\x5Cs+$/g;\x0A    for (i = 0, ii = cookies.length; i < ii; i += 1) {\x0A      cookie = cookies[i].replace(r, \x27\x27);\x0A      if (cookie.indexOf(nameSearchString) === 0) {\x0A        value = unescape(cookie.substring(nameSearchString.length));\x0A        if (value.length === 0) {\x0A          return null;\x0A        }\x0A        return value;\x0A      }\x0A    }\x0A    return null;\x0A  };\x0A\x0A  var writeCookie = function (name, value, days, domain) {\x0A    var date, expires, cookie;\x0A    if (days) {\x0A      date = new Date();\x0A      date.setTime(date.getTime() + (days * 86400000));\x0A      expires = \x22; expires=\x22 + date.toGMTString();\x0A    } else {\x0A      expires = \x22\x22;\x0A    }\x0A    cookie = escape(name) + \x22=\x22 + escape(value) + expires + \x22; path=/;\x22;\x0A    if (domain) {\x0A      cookie += \x22 domain=\x22 + domain;\x0A    }\x0A    document.cookie = cookie;\x0A  };\x0A\x0A  var addShown = function (e) {\x0A    var c = readCookie(\x22_qb_se\x22);\x0A    if (!c) {\x0A      c = {};\x0A    } else {\x0A      try {\x0A        c = JSON.parse(c);  \x0A      } catch (e) {\x0A        c = {};\x0A      }\x0A      \x0A    }\x0A    c[e.cm] = {e:e.e, t: +new Date()};\x0A\x0A    //prune old cookies here (older than 30 days)\x0A    var i, t = +new Date();\x0A\x0A    t -= 30 * 24 * 60 * 60 * 1000;\x0A\x0A    for (i in c) {\x0A      if (c.hasOwnProperty(i)) {\x0A        if (c[i].t < t) {\x0A          delete c[i];\x0A        }        \x0A      }\x0A    }\x0A\x0A    writeCookie(\x22_qb_se\x22, JSON.stringify(c), 365, cookieDomain);\x0A  };\x0A\x0A  var uvCounter = 0;\x0A  var withTransaction = function (f) {\x0A    uvCounter += 1;\x0A    if (window.universal_variable) {\x0A      if (window.universal_variable.transaction) {\x0A        f();\x0A      }\x0A    } else if (uvCounter < 50) {\x0A      setTimeout(function () {\x0A        withTransaction(f);\x0A      }, 500);\x0A    }\x0A  };\x0A\x0A  var generateCreatives = function () {\x0A    var c = readCookie(\x22_qb_se\x22);\x0A    var k, a = [];\x0A    if (c) {\x0A      try {      \x0A        c = JSON.parse(c);\x0A        for (k in c) {\x0A          if (c.hasOwnProperty(k)) {\x0A            a.push({cm: k, e: c[k].e});  \x0A          }\x0A        }\x0A      } catch (e) {}\x0A    }\x0A    return a;\x0A  }\x0A\x0A  _qtd.push = function (data) {\x0A    if (data && data.data && data.data.qb_etc_data) {\x0A      var i, e, etcd;\x0A      etcd = data.data.qb_etc_data;\x0A      for (i = 0; i < etcd.length; i++) {\x0A        e = etcd[i];\x0A        if (e.s === \x221\x22) {\x0A          addShown(e);\x0A          //console.log(\x22showed ex\x22, e.cm);\x0A        }\x0A      }\x0A    }\x0A    _qtd.orig_push.apply(this, arguments);\x0A  };\x0A\x0A\x0A  withTransaction(function () {\x0A    if (readCookie(\x22_qb_se\x22)) {\x0A      window.universal_variable.transaction.shown_creatives = generateCreatives();\x0A      _qtd.push({resendUniversalVariables: 1});     \x0A    }\x0A  });\x0A\x0A})();\x0A<\/script>",locationId:1,positionId:1,locationDetail:"",async:true,needsConsent:false,usesDocWrite:false,pageVars:{},dependencies:[391261]}};
var o=1;var k="pong.qubitproducts.com";var j="";var p=false;var i=1000;p=p||!!window.otDelayDocWrite;function s(u,t){var q,w,v;window["__ot_vars__"+b]=h;s.isSync=s.determineIfSync();if(f){v=s.setupSession()}else{v={}}s.docWriteUsers=[];s.errors={};s.loadersAwaitingConsent=[];s.isTellingLoadTimes=o>Math.random();if(s.isTellingLoadTimes){s.loadTimes={}}q=s.getFilterStates(u,s.getUrl(),v);s.qTagLoaders=s.getLoaders(q,t);s.qTagLoaderCount=0;s.loadTimesSent=false;s.loadersStarted=0;s.loadersFinished=0;s.initialLoadFinished=false;s.canCallLoaded=false;s.hasCalledLoaded=false;s.loadedSomeSync=false;s.runStarters(q,v);s.initialLoadFinished=true;s.waitingForSyncWrites=false;s.handleDedupe(s.qTagLoaders);if(p){c.html.ready(function(){s.sequentiallyLoadingDelayed=false;s.loadLoadersSequentially()})}else{if(s.loadedSomeSync){setTimeout(s.loadLoadersSequentially,100)}else{s.loadLoadersSequentially()}c.html.ready(function(){s.loadLoadersSequentially()})}if(s.canCallLoaded){s.callAllLoaded()}window.opentag_consentCBs=window.opentag_consentCBs||[];window.opentag_consentGiven=window.opentag_consentGiven||function(){var y,z,x;for(y=0,z=window.opentag_consentCBs.length;y<z;y+=1){window.opentag_consentCBs[y]()}};window.opentag_consentCBs.push(s.consentGiven)}s.ALL="1";s.SUBSTRING="2";s.REGEX="3";s.EXACT_MATCH="4";s.FN="100";s.DEDUPE_FN="110";s.FILTER_TYPE_INCLUDE="1";s.FILTER_TYPE_EXCLUDE="2";s.NORMAL_FILTER="1";s.DEDUPE_URL_FILTER="2";s.DEDUPE_SESSION_FILTER="3";s.JS_VALUE="2";s.QUERY_PARAM="3";s.COOKIE_VALUE="4";s.ELEMENT_VALUE="5";s.NOT_LOADED=0;s.LOADING=1;s.LOAD_FAILURE=2;s.LOAD_SUCCESS=3;s.determineIfSync=function(){var u,v,t,q,w;q=document.getElementsByTagName("script");for(u=0,v=q.length;u<v;u+=1){t=q[u];w=t.getAttribute("src");if(!!w&&(w.indexOf("opentag-"+g+"-"+b+".js")>0)){return(t.getAttribute("async")===null&&(t.getAttribute("defer")===false||t.getAttribute("defer")===""||t.getAttribute("defer")===null))}}return true};s.setupSession=function(){var x,u,t,v,y,q;x={};x.sessionCount=c.cookie.SimpleSessionCounter.update(j);y="qtag_"+b;t=c.html.simplecookie.readCookie(y);if(t){try{t=r.parse(t)}catch(w){t={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}}else{t={sc:0,sessionCount:0,pageViews:0,sessionStartTime:0,referrer:[],sessionLandingPage:"",__v:{}}}q=new Date().getTime();if(x.sessionCount!==parseInt(t.sc,10)){t.sessionStartTime=q;t.sc=x.sessionCount;t.sessionCount+=1;t.referrer.push({url:s.getReferrer(),landing:s.getUrl().substring(0,300),time:q});t.sessionLandingPage=s.getUrl().substring(0,300)}else{if(s.isReferrerDifferent()){if(!s.referrerIsSameAsPrevious(t.referrer,q,3*60*1000)){t.referrer.push({url:s.getReferrer(),landing:s.getUrl().substring(0,300),time:q});t.sessionLandingPage=s.getUrl().substring(0,300);t.sessionStartTime=q;t.sessionCount+=1}}}x.sessionCount=t.sessionCount;x.sessionStartTime=t.sessionStartTime;x.pageStartTime=q;t.pageViews+=1;x.pageViews=t.pageViews;x.sessionLandingPage=t.sessionLandingPage;x.referrer=t.referrer;if(x.referrer.length>5){x.referrer.splice(2,x.referrer.length-5)}v=r.stringify(t);u=0;while((v.length>i)&&(u<5)){if(t.referrer.length>=3){t.referrer.splice(2,1)}else{if(t.referrer.length===2){t.referrer=[t.referrer[0]]}else{if(t.referrer.length===1){t.referrer=[]}}}v=r.stringify(t);u+=1}x.referrer=t.referrer;c.html.simplecookie.writeCookie(y,v,-100,"");c.html.simplecookie.writeCookie(y,v,365,j);x.setVariable=function(A,B,C){var z=(!!C)?C:0;t.__v[A]=[B,z];c.html.simplecookie.writeCookie(y,r.stringify(t),365,j)};x.getCookie=c.html.simplecookie.readCookie;x.getVariable=function(C){var z,B,A;z=t.__v[C];if(z){B=z[1];if((B===0)||(B>new Date().getTime())){return z[0]}}return null};x.on=function(B,A,z){if(A.attachEvent){A.attachEvent("on"+B,z)}else{if(A.addEventListener){A.addEventListener(B,z,false)}}};return x};s.referrerIsSameAsPrevious=function(t,v,x){var u,q,w;if(t.length>0){u=s.getReferrer();q=s.getUrl().substring(0,300);w=t[t.length-1];return(w.url===u)&&(w.landing===q)&&((w.time+x)>v)}return false};s.isReferrerDifferent=function(){var v,q,u;u=s.getReferrer();v=u.indexOf("://");if(v===-1){return true}v+=3;try{if(u.substring(v).indexOf(s.getDomain())!==0){return true}return false}catch(t){return true}};s.getReferrer=function(){if(document.referrer){return document.referrer.substring(0,300)}return"direct"};s.getDomain=function(){return document.location.host};s.getUrl=function(){return document.location.href};s.getFilterStates=function(x,q,z){var t,w,v,y={},u=[];if((!x)||(!q)){return u}for(t=0,w=x.length;t<w;t+=1){v=x[t];if(s.doesFilterMatch(v,q,z)){u.push(v)}else{}}u.sort(function(B,A){return A.priority-B.priority});return u};s.getLoaders=function(w,x,t){var u,v,y={},q={};for(u=0,v=w.length;u<v;u+=1){s.updateLoaders(w[u],y)}for(u in y){if(y.hasOwnProperty(u)){q[u]=x[u];q[u].dedupe=y[u];q[u].state=s.NOT_LOADED;q[u].nextLoaders={}}}return q};s.updateLoaders=function(w,x){var t,v,u,q=w.scriptLoaderKeys;if(w.filterType===s.FILTER_TYPE_INCLUDE){for(t=0,v=q.length;t<v;t+=1){u=s.getFilterType(w);if((u===s.NORMAL_FILTER)||(u===s.DEDUPE_URL_FILTER)||(x[q[t]]===s.DEDUPE_URL_FILTER)){x[q[t]]=u}}}else{if(w.filterType===s.FILTER_TYPE_EXCLUDE){for(t=0,v=q.length;t<v;t+=1){delete x[q[t]]}}}};s.getFilterType=function(t){var q=parseInt(t.patternType,10);if((q<10)||(q===100)){return s.NORMAL_FILTER}if((q>=10)&&(q<20)){return s.DEDUPE_URL_FILTER}if(q===110){return s.DEDUPE_SESSION_FILTER}};s.runStarters=function(w,x){var t,v,u;for(t=0,v=w.length;t<v;t+=1){u=w[t];try{u.starter(x,s.createStarterCb(u))}catch(q){}}};s.createStarterCb=function(q){return function(w){var v,x,u,t=[];for(v=0,x=q.scriptLoaderKeys.length;v<x;v+=1){u=s.qTagLoaders[q.scriptLoaderKeys[v]];if(w&&(u.state===s.LOAD_SUCCESS)){u.state=s.NOT_LOADED;u.counted=false}else{if(w){}}if(u&&(u.state===s.NOT_LOADED)&&(u.dedupe!==s.DEDUPE_URL_FILTER)){if(!((u.dedupe===s.DEDUPE_SESSION_FILTER)&&(q.patternType!==s.DEDUPE_FN))){if(!u.counted){u.counted=true;t.push(u)}}}}for(v=0,x=t.length;v<x;v+=1){u=t[v];if(s.hasConsent()||!s.needsConsent(u)){s.loadLoader(u)}else{s.loadersAwaitingConsent.push(u)}}}};s.hasConsent=function(){return c.html.simplecookie.readCookie("qubitconsent")==="Accepted"};s.needsConsent=function(q){return !!q.needsConsent};s.consentGiven=function(){var t,u,q=s.loadersAwaitingConsent;for(t=0,u=q.length;t<u;t+=1){s.loadLoader(q[t])}};s.doesFilterMatch=function(t,q,w){var u=false;switch(t.patternType){case s.FN:case s.DEDUPE_FN:try{u=t.pattern(w)}catch(v){u=false}break;case s.EXACT_MATCH:case"1"+s.EXACT_MATCH:if(q.toLowerCase()===t.pattern.toLowerCase()){u=true}break;case s.SUBSTRING:case"1"+s.SUBSTRING:if(q.toLowerCase().indexOf(t.pattern.toLowerCase())>=0){u=true}break;case s.REGEX:case"1"+s.REGEX:if(new RegExp(t.pattern).test(q)){u=true}break;case s.ALL:case"1"+s.ALL:u=true;break}if(u&&!t.starter){t.starter=s.defaultStarter}return u};s.defaultStarter=function(t,q){q()};s.waitCounts={};s.maxLoads=10;s.loadCheckInterval=500;s.loadLoader=function(q){var t;if((q.state===s.NOT_LOADED)&&s.dependenciesExist(q)){try{q.state=s.LOADING;if(q.usesDocWrite&&!(s.isSync&&!q.async)){s.docWriteUsers.push(q);s.loadLoadersSequentially()}else{s.doWhenReady(q,s.loadTagLoader,function(){})}}catch(u){q.state=s.LOAD_FAILURE;t={reason:"error parsing loader, "+q.id+": "+u.reason,url:document.location.href};s.errors[q.id]=t;if(window.debug){window.console.log(t)}}}};s.dependenciesExist=function(q){var u,v,w,t,x=true;w=q.dependencies;if(!w){return true}for(u=0,v=w.length;u<v;u+=1){t=s.qTagLoaders[w[u]];if(!t){x=false}else{if(t.state!==s.LOAD_SUCCESS){t.nextLoaders[q.id]=true;x=false}else{}}}return x};s.doWhenReady=function(q,t,u){s.waitCounts[q.id]=0;s._doWhenReady(q,t,u)};s._doWhenReady=function(q,t,u){if(s.canLoad(q)){s.qTagLoaderCount+=1;t(q)}else{if(s.waitCounts[q.id]<s.maxLoads){s.waitCounts[q.id]+=1;setTimeout(function(){s._doWhenReady(q,t,u)},s.loadCheckInterval)}else{u(q)}}};s.canLoad=function(q){return s.elementExists(q)&&s.pageVariablesExist(h,q)};s.elementExists=function(q){if(s.isSync&&!q.async){return true
}else{if(q.locationId===2){return !!document.body}else{if(q.locationId===3){return !!document.getElementById(q.locationDetail)}}}return true};s.pageVariablesExist=function(u,q){var t,v;if(!q.pageVars){return true}for(t in q.pageVars){if(q.pageVars.hasOwnProperty(t)){try{v=s.pageVariableExists(u[t]);if(!v){return false}}catch(w){return false}}}return true};s.pageVariableExists=function(v){var t,u,q=false;switch(v.type){case s.JS_VALUE:try{if(v.value.indexOf("[#]")===-1){c.html.GlobalEval.globalEval("window.__var_test = ("+v.value+")");t=window.__var_test}else{t=s.getArrayPageVariableExists(v);if(t){c.html.GlobalEval.globalEval("window.__var_test = ("+t+")");t=window.__var_test;q=true}}}catch(w){t=null}break;case s.QUERY_PARAM:t=s.getQueryParam(v.value);break;case s.COOKIE_VALUE:t=s.getCookieValue(v.value);break;case s.ELEMENT_VALUE:t=s.getElementValue(v.value);break}u=s.variableExists(t);if(u){v.pageValue=t;v.isArray=q}return u};s.getArrayPageVariableExists=function(q){var t,A,y,z,w,B,u;z=true;w=false;B="";u=q.value.split("[#]");for(t=0,A=u.length-1;z&&(t<A);t+=1){B+=u[t];try{c.html.GlobalEval.globalEval("window.__var_test = ("+B+")");y=window.__var_test}catch(v){z=false}z=z&&s.variableExists(y);if(z){if(y.length===0){w=true;break}B+="[0]"}}if(!z){return null}else{if(w){return B}else{return q.value.replace("[#]","[0]")}}};s.variableExists=function(q){return(q!==undefined)&&(q!==null)};s.getQueryParam=function(z){var u,v,y,t,x,q,w;t=s.getUrl();if(t.indexOf("?")>0){q=t.substring(t.indexOf("?")+1).split("&");for(u=0,v=q.length;u<v;u+=1){x=q[u];if(x.indexOf("=")>0){w=x.split("=");if((w.length===2)&&(w[0]===z)){return w[1]}}}}return null};s.getCookieValue=function(q){return c.html.simplecookie.readCookie(q)};s.getElementValue=function(q){var t=document.getElementById(q);if(t){return t.textContent||t.innerText}return null};s.loadingSequentially=false;s.waitingForSyncWrites=true;s.sequentiallyLoadingDelayed=p;s.loadLoadersSequentially=function(){var t,u,v,q;if(!s.waitingForSyncWrites&&!s.sequentiallyLoadingDelayed&&!s.loadingSequentially&&(s.docWriteUsers.length>0)){s.loadingSequentially=true;q=false;for(u=0,v=s.docWriteUsers.length;u<v;u+=1){t=s.docWriteUsers[u];if(s.canLoad(t)){s.docWriteUsers.splice(u,1);q=true;break}}if(q){s.doWhenReady(t,s.loadLoaderSequentially,function(){s.loadLoadersSequentially()})}else{s.loadingSequentially=false}}else{}};s.loadLoaderSequentially=function(t){var v=[],u,q;document.write=function(w){v.push(w)};document.writeln=function(w){v.push(w)};u=function(){var w=s.getLocation(t);c.html.HtmlInjector.inject(w,t.positionId===1,v.join("\n"),function(){})};t.finishHandler=u;s.loadTagLoader(t)};s.loadTagLoader=function(q){s.substituteValues(h,q);var t=s.getTimerEnder(q);try{if(q.url){if(!q.async&&s.isSync){s.loadTagLoaderSync(q)}else{c.html.fileLoader.load(q.url,s.getTimerStarter(q),t,q.parentNode,q.async)}}else{if(q.html){s.injectHtml(q)}}}catch(u){t(null,u,true)}};s.substituteValues=function(t,q){s._substituteValues(t,q,"html");s._substituteValues(t,q,"pre");s._substituteValues(t,q,"post");s._substituteValues(t,q,"url")};s._substituteValues=function(w,t,v){var x,z,u,q="_"+v,y;if(!t[q]){t[q]=t[v]}y=t[q];if(y&&y.length>0){for(z in t.pageVars){if(t.pageVars.hasOwnProperty(z)){x=w[z];u="\\${"+t.pageVars[z]+"}";if(x.isArray){y=s.substituteArray(x,u,y)}else{if(x.pageValue instanceof Array){y=y.replace(new RegExp(u,"g"),"window.__ot_vars__"+b+"["+z+"].pageValue")}else{y=y.replace(new RegExp(u,"g"),x.pageValue)}}}}t[v]=y}};s.substituteArray=function(w,v,x){var y,q,u,t;u=w.value.indexOf("[#]");y=w.value.substring(0,u);q=w.value.substring(u+3);x=x.replace(new RegExp(v+"\\.length","g"),y+".length");x=x.replace(new RegExp(v+"(\\[.*?\\])","g"),y+"$1"+q);return x};s.loadTagLoaderSync=function(q){var t,v="scr",u;s.getTimerStarter(q)();t=c.html.fileLoader.tidyUrl(q.url);u="<"+v+"ipt type='text/javascript' src='"+t+"'></"+v+"ipt>";document.write(u);s.loadedSomeSync=true;s.getTimerEnder(q)()};s.injectHtml=function(q){var t=s.getLocation(q);s.getTimerStarter(q)();c.html.HtmlInjector.inject(t,q.positionId===1,q.html,s.getTimerEnder(q))};s.getLocation=function(q){var t;if(q.locationId===1){t=document.getElementsByTagName("head")[0]}else{if(q.locationId===2){t=document.body}else{if(q.locationId===3){t=document.getElementById(q.locationDetail)}else{t=document.body}}}return t};s.getTimerStarter=function(q){if(s.isTellingLoadTimes){s.loadTimes[q.id]={start:new Date().getTime()}}return s.createStatementEvaluator(q.url?q.pre:"",true)};s.getTimerEnder=function(q){var t=false;return function(v,u,w){if(t){return}t=true;try{if(s.isTellingLoadTimes){s.loadTimes[q.id].end=new Date().getTime()}if(q.finishHandler){q.finishHandler()}s.createStatementEvaluator((!w&&!!q.url)?q.post:"",false)();if(u){s.errors[q.id]=u;q.state=s.LOAD_FAILURE}else{q.state=s.LOAD_SUCCESS}if(s.loadingSequentially){s.loadingSequentially=false}s.loadLoadersSequentially();if(!w){s.loadDependentScripts(q)}}catch(x){if(window.debug){window.console.log(x)}}}};s.loadDependentScripts=function(q){var t;for(t in q.nextLoaders){if(q.nextLoaders.hasOwnProperty(t)){if(s.qTagLoaders[t]){s.loadLoader(s.qTagLoaders[t])}}}};s.createStatementEvaluator=function(q,t){if((!!q)&&(q.length>0)){return function(){c.html.GlobalEval.globalEval(q);s.incrementLoadCounter(t)}}else{return function(){s.incrementLoadCounter(t)}}};s.incrementLoadCounter=function(q){if(q){s.loadersStarteded+=1;s.canCallLoaded=false}else{s.loadersFinished+=1}if((s.loadersFinished===s.qTagLoaderCount)||(s.loadTimesSent&&(s.loadersStarted===s.loadersFinished))){s.sendLoadTimes();s.canCallLoaded=true;if(s.initialLoadFinished){s.callAllLoaded()}s.loadTimesSent=true}};s.callAllLoaded=function(){if(!s.hasCalledLoaded){s.hasCalledLoaded=true;if(window.qTag_allLoaded){window.qTag_allLoaded()}}};s.sendLoadTimes=function(){var u,t,q,w,v;if(!s.isTellingLoadTimes){return}t="c="+g+"&p="+b+"&l="+(o)+"&pv="+c.cookie.PageView.update()+"&d=";q=[];v=s.loadTimes;for(u in v){if(v.hasOwnProperty(u)){w=s.loadTimes[u];q.push('"'+u+'":'+(w.end-w.start));delete s.loadTimes[u]}}t+=encodeURIComponent("{"+q.join(",")+"}");if(k){c.html.PostData("//"+k+"/tag2?"+t,null,"GET")}s.sendErrors()};s.sendErrors=function(){if(!window.openTag_sendErrors){return}var u,t,v,q=[];for(u in s.errors){if(s.errors.hasOwnProperty(u)){t=s.errors[u];q.push("{r: '"+t.reason+"',u:'"+t.url+"',l:'"+t.lineNumber+"'}")}}if(q.length>0){if(window.debug){window.console.log(q.join(","))}v="c="+g+"&p="+b+"&pv="+c.cookie.PageView.update()+"&e="+("["+q.join(",")+"]");if(k){c.html.PostData("//"+k+"/tag_err?"+v,null,"GET")}}};s.handleDedupe=function(q){s.sendDedupePings(s.determineDedupeLoaders(q))};s.determineDedupeLoaders=function(x,w){var t,u,v,q;t=[];for(u in x){if(x.hasOwnProperty(u)){q=x[u];if((q.dedupe===s.DEDUPE_URL_FILTER)&&(q.state===s.NOT_LOADED)){t.push(q)}}}return t};s.sendDedupePings=function(u){var v,w,t,x,q;if(s.isTellingLoadTimes){x="c="+g+"&p="+b+"&l="+(o)+"&pv="+c.cookie.PageView.update()+"&dd=";q=[];for(v=0,w=u.length;v<w;v+=1){t=u[v];q.push(t.id)}x+=encodeURIComponent("["+q.join(",")+"]");if(k&&q.length>0){c.html.PostData("//"+k+"/tag2?"+x,null,"GET")}}};var a=function(){var q=false;if(c.html.simplecookie.readCookie("opentag_debug")){q=true}if(document.location.href.indexOf("opentag_debug")>=0){q=true}return q};if(a()){var m=document.createElement("script");m.src="//s3-eu-west-1.amazonaws.com/opentag/opentag-"+g+"-"+b+"-debug.js";document.getElementsByTagName("head")[0].appendChild(m)}else{var l=new s(d||[],n||{})}}())}catch(e){try{if(window.debug){console.log(e)}}catch(ex){}};